<html>
  <head>
    <meta charset='utf-8' />
    <title>Forge | Reference Libraries</title>
    <meta content='width=device-width, initial-scale=1.0' name='viewport' />
    <style type='text/css'>
      /*<![CDATA[*/
        body {
          padding-top: 60px;
        }
      /*]]>*/
    </style>
    <script src='//cdnjs.cloudflare.com/ajax/libs/jquery/1.7.1/jquery.min.js' type='text/javascript'></script>
    <link href='/images/favicon.ico' rel='icon' />
    <link href='/stylesheets/styles.css' rel='stylesheet' type='text/css' />
    <link href='/stylesheets/bootstrap-responsive.min.css' rel='stylesheet' type='text/css' />
    <link href='/stylesheets/prettify.css' rel='stylesheet' type='text/css' />
    <!--[if lt IE 9]>
      <script src='//html5shim.googlecode.com/svn/trunk/html5.js' type='text/javascript'></script>
    <![endif]-->
    <script src='/javascripts/bootstrap.min.js' type='text/javascript'></script>
    <script src='/javascripts/bootstrap-collapse.js' type='text/javascript'></script>
    <script src='/javascripts/prettify.js' type='text/javascript'></script>
    <script src='/javascripts/videoscale.js' type='text/javascript'></script>
    <script type='text/javascript'>
      //<![CDATA[
        $(document).ready(function() {
          $("pre.prettyprint code").removeClass("prettyprint").removeClass("linenums");
          prettyPrint();
        });
      //]]>
    </script>
    <script type='text/javascript'>
      //<![CDATA[
        $(document).ready(function() {
          var pathname = window.location.pathname;
          console.log(pathname);
          $("body > .navbar a[href='" + pathname + "']").closest("li").addClass("active");
          $("body > #content ul.nav a[href='" + pathname + "#content']").closest("li").addClass("active");
        });
      //]]>
    </script>
    <script type='text/javascript'>
      //<![CDATA[
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-34467975-1']);
        _gaq.push(['_trackPageview']);
        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      //]]>
    </script>
  </head>
  <body>
    <div class='navbar navbar-fixed-top'>
      <div class='navbar-inner'>
        <div class='container'>
          <div class='github-banner hidden-phone'>
            <a href='https://github.com/forge/forge.github.com'>
              <img alt='Fork me on GitHub' src='https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png' style='position:absolute;top:0;right:0;border:0;' />
            </a>
          </div>
          <a class='btn btn-navbar' data-target='.nav-collapse' data-toggle='collapse'>
            <span class='icon-bar'></span>
            <span class='icon-bar'></span>
            <span class='icon-bar'></span>
          </a>
          <a class='brand' href='/index.html'>
            <img alt='JBoss Forge' class='forge-logo' src='/images/jbossforge_icon_256px.png' />
          </a>
          <div class='nav-collapse'>
            <ul class='nav'>
              <li>
                <a href='/index.html'>Home</a>
              </li>
              <li>
                <a href='/docs/index.html'>Documentation</a>
              </li>
              <li>
                <a href='/team.html'>Team</a>
              </li>
              <li>
                <a href='https://community.jboss.org/en/forge'>Forums</a>
              </li>
              <li>
                <a href='/plugins.html'>Plugins</a>
              </li>
              <li>
                <a href='https://issues.jboss.org/browse/FORGE' target='issue tracker'>Issue Tracker</a>
              </li>
              <li>
                <a href='https://issues.jboss.org/browse/FORGE#selectedTab=com.atlassian.jira.plugin.system.project%3Aroadmap-panel' target='roadmap'>Roadmap</a>
              </li>
              <li>
                <a href='/events.html'>Events</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class='container' id='content'>
      <div class='container'>
  <div class='row'>
    <div class='span3'>
      <ul class='nav nav-list'>
        <li class='nav-header'>Using Forge</li>
        <li>
          <a href='/docs/using/#content'>Installation</a>
        </li>
        <li>
          <a href='/docs/using/installing-new-plugins.html#content'>Installing new Plugins</a>
        </li>
        <li>
          <a href='/docs/using/basic-javaee-app.html#content'>Writing Basic Java EE App</a>
        </li>
        <li>
          <a href='/docs/using/samples.html#content'>Samples</a>
        </li>
        <li>
          <a href='/docs/using/configure-proxy.html#content'>Configure HTTP Proxy</a>
        </li>
        <li>
          <a href='/docs/using/profiling-forge.html#content'>Profiling Forge</a>
        </li>
        <li>
          <a href='/docs/using/debugging-forge.html#content'>Debugging Forge</a>
        </li>
        <li>
          <a href='/docs/using/faq.html#content'>FAQ</a>
        </li>
        <li>
          <a href='/docs/using/affiliation.html#content'>Affiliation</a>
        </li>
        <li class='nav-header'>Get involved</li>
        <li>
          <a href='/docs/get_involved/contribute.html#content'>Contribute or Get Involved</a>
        </li>
        <li>
          <a href='/docs/get_involved/release-guide.html#content'>Release Guide</a>
        </li>
        <li>
          <a href='/docs/get_involved/write-docs.html#content'>Improve our documentation</a>
        </li>
        <li class='nav-header'>Important plugins</li>
        <li>
          <a href='/docs/important_plugins/arquillian-testing.html#content'>Arquillian Testing</a>
        </li>
        <li>
          <a href='/docs/important_plugins/ui-scaffolding.html#content'>UI Scaffolding</a>
        </li>
        <li class='nav-header'>Developing plugins</li>
        <li>
          <a href='/docs/plugin_development/#content'>Developing a plugin</a>
        </li>
        <li>
          <a href='/docs/plugin_development/reference-forge-api.html#content'>Reference Forge API</a>
        </li>
        <li>
          <a href='/docs/plugin_development/implement-plugin-interface.html#content'>Implement the Plugin interface</a>
        </li>
        <li>
          <a href='/docs/plugin_development/give-your-plugin-name.html#content'>Give your Plugin a name</a>
        </li>
        <li>
          <a href='/docs/plugin_development/add-commands-to-plugin.html#content'>Add Commands to your Plugin</a>
        </li>
        <li>
          <a href='/docs/plugin_development/add-options-to-command.html#content'>Add Options to your Commands</a>
        </li>
        <li>
          <a href='/docs/plugin_development/enable-piping.html#content'>Enable Piping between Commands</a>
        </li>
        <li>
          <a href='/docs/plugin_development/facets.html#content'>Enable modular functionality with Facets</a>
        </li>
        <li>
          <a href='/docs/plugin_development/test-plugins.html#content'>Test your Plugin</a>
        </li>
        <li>
          <a href='/docs/plugin_development/reference-libraries.html#content'>Reference Libraries</a>
        </li>
        <li>
          <a href='/docs/plugin_development/make-plugin-available.html#content'>Make your Plugin available to Forge</a>
        </li>
        <li>
          <a href='/docs/plugin_development/add-plugin-cpi.html#content'>Add your Plugin to the Central Plugin Index</a>
        </li>
        <li>
          <a href='/docs/plugin_development/important-apis.html#content'>Important APIs</a>
        </li>
      </ul>
    </div>
    <div class='span9'>
      <h1>Ensure all referenced libraries are on the <span class="caps">CLASSPATH</span></h1>
<div class="alert alert-info">As of Forge 1.0.0.Beta1, no special action is required to include plugin dependencies. Forge will read your Plugin <span class="caps">POM</span> file and create the proper dependency references; subsequently, any dependencies with the groupId, &#8220;<strong>org.jboss.forge</strong>&#8221; are considered to be <strong>reserved</strong> by Forge, and will be marked as &#8220;<strong>provided</strong>&#8221; scope, and thus, ignored if not provided as part of the core runtime.</div>
<p>If you are experiencing overwhelming issues with a ClassLoader, and cannot work around the modular environment, Forge offers an alternate Plugin packaging mode that can be activated by setting a flag in your Plugin&#8217;s src/main/resources/<span class="caps">META</span>-<span class="caps">INF</span>/forge.xml file:</p>
<pre class="prettyprint linenums"><code class="prettyprint linenums">&lt;forge&gt;&#x000A;  &lt;dependencies-as-resource-root/&gt;&#x000A;&lt;/forge&gt;</code></pre>
<p>This will cause Forge to bundle all dependencies for your Plugin in the Plugin module itself, instead of creating a separate &#8220;dependencies&#8221; module, with a separate ClassLoader.</p>
<p>As a last resort, you may also shade code into your plugin&#8217;s <span class="caps">JAR</span> file; however, this is extremely discouraged, since you may cause ClassCastExceptions at runtime, and this increases the burden on Class scanning at boot time, because <span class="caps">CDI</span> will scan all classes in your Plugin <span class="caps">JAR</span> file.</p>
<p>Using Forge to set up Shading</p>
<pre class="command"><code class="command">[example-plugin] example-plugin $ shade setup&#x000A;***SUCCESS*** Shade plugin is installed.&#x000A;[example-plugin] example-plugin $&#x000A;[example-plugin] example-plugin $ shade include commons-collections:commons-collections:3.2.1</code></pre>
<p>Notice that the pom.xml file has been modified and now includes a shade configuration including commons-collections.</p>
<pre class="prettyprint linenums"><code class="prettyprint linenums">&lt;plugin&gt;&#x000A;        &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;&#x000A;        &lt;version&gt;1.4&lt;/version&gt;&#x000A;        &lt;executions&gt;&#x000A;          &lt;execution&gt;&#x000A;            &lt;phase&gt;package&lt;/phase&gt;&#x000A;            &lt;goals&gt;&#x000A;              &lt;goal&gt;shade&lt;/goal&gt;&#x000A;            &lt;/goals&gt;&#x000A;            &lt;configuration&gt;&#x000A;              &lt;artifactSet&gt;&#x000A;                &lt;includes&gt;&#x000A;                  &lt;include&gt;commons-collections:commons-collections&lt;/include&gt;&#x000A;                &lt;/includes&gt;&#x000A;              &lt;/artifactSet&gt;&#x000A;            &lt;/configuration&gt;&#x000A;          &lt;/execution&gt;&#x000A;        &lt;/executions&gt;&#x000A;      &lt;/plugin&gt;</code></pre>
<div class="alert alert-danger">Do <span class="caps">NOT</span> include Forge provided libraries with shade, or you will very likely create a non-functional plugin.</div>
<p>It it also recommended, however, to relocate shaded class files to a new package. Your code will access the bundled code at this new location, and will prevent version conflicts if another plugin bundles a different version of the same library. For this, we use the following command.</p>
<pre class="command"><code class="command">$ shade relocate --pattern {ORIGINAL PGK} --shadedPattern {NEW PKG} --excludes {EXCLUDED PKGS...}</code></pre>
<p>For the purposes of this example, let us assume that our Plugin depends on the Apache Commons Collections library (org.apache.commons.collections), and we want to make sure that no conflicts occur.</p>
<pre class="command"><code class="command">[example-plugin] example-plugin $ shade relocate --pattern org.apache.commons.collections --shadedPattern ~.shaded.apache.collections&#x000A;***SUCCESS*** Relocating [org.apache.commons.collections] to [com.example.forge.plugin.shaded.apache.collections]&#x000A;[example-plugin] example-plugin $</code></pre>
<p>This should be repeated for each dependency as necessary. Notice that our <span class="caps">POM</span> has been updated with the configuration:</p>
<pre class="prettyprint linenums"><code class="prettyprint linenums">&lt;plugin&gt;&#x000A;     &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;&#x000A;     &lt;version&gt;1.4&lt;/version&gt;&#x000A;     &lt;executions&gt;&#x000A;       &lt;execution&gt;&#x000A;         &lt;phase&gt;package&lt;/phase&gt;&#x000A;         &lt;goals&gt;&#x000A;           &lt;goal&gt;shade&lt;/goal&gt;&#x000A;         &lt;/goals&gt;&#x000A;         &lt;configuration&gt;&#x000A;           &lt;artifactSet&gt;&#x000A;             &lt;includes&gt;&#x000A;               &lt;include&gt;commons-collections:commons-collections&lt;/include&gt;&#x000A;             &lt;/includes&gt;&#x000A;           &lt;/artifactSet&gt;&#x000A;           &lt;relocations&gt;&#x000A;             &lt;relocation&gt;&#x000A;               &lt;pattern&gt;org.apache.commons.collections&lt;/pattern&gt;&#x000A;               &lt;shadedPattern&gt;com.example.forge.plugin.shaded.apache.collections&lt;/shadedPattern&gt;&#x000A;             &lt;/relocation&gt;&#x000A;           &lt;/relocations&gt;&#x000A;         &lt;/configuration&gt;&#x000A;       &lt;/execution&gt;&#x000A;     &lt;/executions&gt;&#x000A;   &lt;/plugin&gt;</code></pre>
<p>When you build your plugin, you should see confirmation output from the Maven Shade Plugin looking something like this:</p>
<pre class="command"><code class="command">[INFO] --- maven-shade-plugin:1.4:shade (default) @ example-plugin ---&#x000A;[INFO] Excluding org.jboss.seam.forge:forge-shell-api:jar:{version} from the shaded jar.&#x000A;[INFO] Excluding org.jboss.seam.forge:forge-parser-java-api:jar:{version} from the shaded jar.&#x000A;[INFO] Excluding org.jboss.seam.forge:forge-parser-xml:jar:{version} from the shaded jar.&#x000A;[INFO] Excluding org.jboss.shrinkwrap.descriptors:shrinkwrap-descriptors-api:jar:{version} from the shaded jar.&#x000A;[INFO] Excluding javax.enterprise:cdi-api:jar:{version} from the shaded jar.&#x000A;[INFO] Excluding org.jboss.spec.javax.interceptor:jboss-interceptors-api:jar:{version} from the shaded jar.&#x000A;[INFO] Excluding javax.annotation:jsr250-api:jar:{version} from the shaded jar.&#x000A;[INFO] Excluding javax.inject:javax.inject:jar:{version} from the shaded jar.&#x000A;[INFO] Including commons-collections:commons-collections:jar:3.2.1 in the shaded jar.&#x000A;[INFO] Replacing original artifact with shaded artifact.&#x000A;[INFO] Replacing ~/Desktop/example-plugin/target/example-plugin-1.0.0-SNAPSHOT.jar&#x000A;   with ~/Desktop/example-plugin/target/example-plugin-1.0.0-SNAPSHOT-shaded.jar&#x000A;[INFO] ------------------------------------------------------------------------&#x000A;[INFO] BUILD SUCCESS&#x000A;[INFO] ------------------------------------------------------------------------</code></pre>
<h2>Default dependencies</h2>
<p>During plugin installation, Forge adds certain modules as dependencies to the plugin module. Forge adds the <code>org.jboss.forge.javaee.api</code>, <code>org.jboss.forge.maven.api</code>, <code>org.jboss.forge.scaffold.api</code>, <code>org.jboss.forge.shell.api</code>, <code>org.jboss.seam.render</code> and <code>javax.api</code> modules as dependencies to your plugin. These modules already exist in a Forge installation and are added as dependencies to the plugin module, so they&#8217;re readily available during plugin execution.</p>
<p>If you chose to use the default plugin packaging mode, Forge creates an additional &#8216;dependencies&#8217; module as a dependency for your plugin during installation. The &#8216;dependencies&#8217; module contains all the dependencies with an effective scope of runtime, that are present anywhere in the dependency hierarchy of your plugin project. The artifacts constituting the dependencies are added as resource roots to the &#8216;dependencies&#8217; module. In general, project <span class="caps">POM</span> dependencies with <code>org.jboss.forge</code> groupId will be omitted from the &#8216;dependencies&#8217; module.</p>
    </div>
  </div>
</div>
      <hr />
      <footer>
        <p>&copy; JBoss 2013</p>
      </footer>
    </div>
  </body>
</html>
